<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>TSP</title>
    <link rel="stylesheet" href="style.css">
    <script src="keyevents.js" defer></script>
    <script src="player.js" defer></script>
    <script src="colliding.js" defer></script>
    <script src="script.js" defer></script>
    <script src="scenarios.js" defer></script>
    <script src="end.js" defer></script>
    <script src="basic.js" defer></script>
    <script src="spriteGame.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
    <script src="typing.js" defer></script>
    <script src="balancing.js" defer></script>
    <script src="climb.js" defer></script>
    <script src="hallucinations.js" defer></script>
</head>
<body>
    <div id="flickerScreen"></div>
    <div id="sounds">
        <audio id="wiwo" src="audio/Wiwo.mp3"></audio>
        <audio id="batsSound" src="audio/bats.mp3"></audio>
    </div>

    <!--------------------------------------
    ---------------Start Screen-------------
    ---------------------------------------->
    <div id="firstPage">

        <p id="title">The Sleeper's Paradox</p>
        <div id="infoButton" onclick="showInfos()">?</div>
        <div id="infos">
            <p>You're trapped in an endless nightmare - but to wake up, you have to face every single one of them. Can you make it to the morning?</p>
            <div id="closeButton" onclick="closeInfos()">Close</div>
        </div>
        <div id="startText" onclick="goToInputPage()">Start</div>
        <div id="skip" onclick="skip()">Skip</div>
    </div>

    <!--------------------------------------
    ---------------Input Screen-------------
    ---------------------------------------->
    <div id="inputPage">
        <p id="inputTitle">User Profile</p>
        <div id="inputScreen">
            Name: 
            <input id="nameInput" type="text">
            <br>
            Mute: 
            <label class="switch">
                <input type="checkbox" id="muteToggle">
                <span class="slide round"></span>
            </label>
            <br>
            Volume:
            <div class="slidecontainer">
                <input type="range" min="1" max="100" value="50" class="slider" id="myRange">
            </div>
            <div id="saveButton" onclick="saveAndStart()">Save and start</div>
        </div>
    </div>

    <!--------------------------------------
    ---------------First Level--------------
    ---------------------------------------->
    <div id="spiderPage">
        <div id="scenarioBox1">
            <p id="scenario">
                <span>You wake up, in complete darkness. The air is damp,</span>
                <span>and a faint skittering noise echoes through the</span>
                <span>cave. As your eyes adjust, you realize the walls are</span>
                <span>covered in thick, web-like strands. A dim glow</span>
                <span>pulses in the distance, revealing several shadowy</span>
                <span>tunnels ahead. As you move forward cautiously, you</span>
                <span>suddenly hear a loud chittering above you. You look</span>
                <span>up and see a mass of huge, glistening eyes staring</span>
                <span>down at you from the ceiling. A massive spider</span>
                <span>lowers itself on a web, blocking your path. Its</span>
                <span>fangs click together, dripping with something dark</span>
                <span>and venomous. It doesn't attack immediately—it's</span>
                <span>waiting to see what you'll do.</span>
            </p>
            <br>
            <p id="question">What will you do?</p>
        </div>
        <div id="options1">
            <div class="option" id="option1" onclick="checkStatus(-5, 1)">
                Take slow steps backwards, trying to be quiet
            </div>
            <div class="option" id="option2" onclick="checkStatus(0, 1)">
                Stay still and don't make a sound
            </div>
            <div class="option" id="option3" onclick="checkStatus(100, 1)">
                Turn around and run away as fast as you can
            </div>
        </div>
    </div>

    
    <!--------------------------------------
    ---------------Sprite Game--------------
    ---------------------------------------->
    <div id="drowningScreen">
        <div id="infosD" style="display: none;">
            <span>At first, you don't realize how quickly the water is rising.</span><br>
            <span>It's just a trickle at your feet, barely noticeable.</span><br>
            <span>But then—it's higher.</span><br>
            <span>The water creeps up your boots, cold and unrelenting.</span><br>
            <span>The quiet of the chamber is broken only by the faint</span><br>
            <span>sound of it lapping against stone.</span><br>
            <span>The exit still isn't clear, and the water continues to rise,</span><br>
            <span>pushing you toward a new urgency. Then - a small sunbeam from above.</span><br>
            <span></span><br>
            <span>Swim upward, but be careful!</span><br>
            <span></span><br>
            <span onclick="showVideo()">Read</span><br>
        </div>
        <div id="surface" style="display: none;">
            <div id="timer">55</div>
            <div id="player">
                <img id="spriteImg" src="img/sprite_sheet.png" alt="sprite_sheet">
            </div>
            <div id="redBox"></div>
        </div>
        <div id="meet" style="display: none;">
            <div id="infosM">
                <span>With the last of your strength, you push yourself up, hauling your soaked body through the narrow opening.</span><br>
                <span>Your clothes cling to your skin, heavy and cold, and every movement feels slower than it should.</span><br>
                <span>You drag yourself onto solid ground, gasping for air, water pooling beneath you. As your eyes adjust, you spot someone slumped against the stone wall ahead</span><br>
                <span>—a man, barely conscious, his clothes torn and filthy, his face pale and hollow.</span><br>
                <span>He looks up at you weakly, as if even that small movement costs him everything he has left.</span><br><br>
                <span id="tth" onclick="talkToMan()">Talk to him</span>
            </div>
            <div id="chat">
                <div id="you">Hello?</div>
                <div id="he"><span id="textHe"></span></div>
            </div>
            <div onclick="continueThen()" id="continue">Continue</div>
        </div>
        <div id="way">
            <video id="greenVideo" src="img/batsVid.webm" autoplay></video>
        </div>
        <div id="afterBats">
            <div id="infosB">
                <span>The air is still again, the echo of wings fading into the distance.</span><br>
                <span>You stand there, catching your breath, heart still racing from the sudden chaos.</span><br>
                <span>Something glints on the ground ahead—three small objects, scattered across the stone floor.</span><br>
                <span>Dropped, maybe left behind. </span><br>
                <span>The passage stretches on, but something about them holds you there.</span><br>
                <span></span><br>
                <span>You can look at one of them.</span><br>
                <br>
                <span onclick="showOptions()">Continue...</span>
            </div>
            <div id="chooseDisplay">
                <div id="infosN">Which one will you choose? Each one of them is meant for an upcoming situation. Remember your hint!</div>
                <div id="imgs">
                    <img src="img/notes/paper.png" alt="1" onclick="choosePic(this)">
                    <img src="img/notes/paper.png" alt="2" onclick="choosePic(this)">
                    <img src="img/notes/paper.png" alt="3" onclick="choosePic(this)">
                    <div id="textChoose" onclick="showChosenNote()">Choose</div>
                </div>
            </div>
            <div id="note"></div>
        </div>
    </div>

    
    <!--------------------------------------
    --------------Heights Screen-------------
    ---------------------------------------->
    <div id="heightsScreen">
        <div id="infosH">
            <span>The air shifts, a chill creeping in as the tunnel ahead narrows, the walls closing in around you.</span><br>
            <span>You halt, feet skirting the edge of the drop, staring down into the abyss below.</span><br>
            <span>Nothing but the stone path before you, winding dangerously along the cliff, the wind howling in your ears.</span><br>
            <span>It's a tightrope—no way back, only the path ahead.</span><br>
            <span>Every step feels like it could be your last, the drop too far and too fast to survive.</span><br>
            <span></span><br>
            <span>But there's no other choice.</span><br>
            <br>
            <span onclick="balance()">Continue...</span>
        </div>
        <div id="tut">
            <span>Use left and right arrow to balance out your way. Watch out, so you don't fall</span><br>
            <span>Watch the red dot - you can move when you're balanced enough. Be fast - you only have 50 seconds!</span>
            <span>Make sure to keep your angle under 25°, or you will fall!</span><br><br>
            <span onclick="startBalancing()">Start</span>
        </div>
        <div id="game">
            <div id="timer2">50</div>
            <div id="stick"></div>
            <div class="path-container">
                <svg width="100%" height="100%" viewBox="0 0 240 300">
                    <path id="myPath" d="M 20 280 C 60 200, 90 150, 130 150 C 170 150, 200 80, 240 20"
                          stroke="lightgreen" fill="transparent" stroke-width="2"/>
                    <circle id="dot" r="5" fill="red" cx="20" cy="280" />
                </svg>
            </div>
        </div>
        <div id="afterBalancing">
            <div id="infosC">
                <span>You make it across—carefully, foot by foot along the narrow ledge, every shift in weight making the stone creak beneath you.</span><br>
                <span>Your breath is shallow, focused, until finally, you reach the other side. Solid ground. You made it.</span><br>
                <span>You let out a slow exhale, tension bleeding from your shoulders as you take a cautious step forward—</span><br>
                <span>And then the ground disappears.</span><br>
                <span>A patch of loose rock crumbles under your weight. There's no time to react—</span><br>
                <span>Your foot slips, your balance vanishes, and you drop into a hidden crack in the earth.</span><br>
                <span>The space is tight, barely wide enough to catch your fall without crushing you.</span><br>
                <span>You're wedged in, bruised and breathless. The air is still, the stone cold against your back.</span><br>
                <span>There's no space to turn around. No way back.</span><br>
                <span>Just one way forward—up.</span><br><br>
                <span onclick="climb()">Continue...</span>
            </div>
        </div>
    </div>

    <!--------------------------------------
    -------------Climbing Screen------------
    ---------------------------------------->
    <div id="climbScreen">
        <div id="tut2">
            <span>Use left and right arrow to balance out your way. Watch out, so you don't fall</span><br>
            <span>Watch the red dot - you can move when you're balanced enough. Be fast - you only have 50 seconds!</span>
            <span>Make sure to keep your angle under 25°, or you will fall!</span><br><br>
            <span onclick="startClimbing()">Start</span>
        </div>
        <div id="timer3">15</div>
        <canvas id="gameCanvas" width="1000" height="600"></canvas>
    </div>

    <!--------------------------------------
    ---------------Story Screen-------------
    ---------------------------------------->
    <div id="storyscreen">
        <div id="infosS">
            <span>The crack releases you into open air, and for the first time in what feels like hours, you can breathe freely.</span><br>
            <span>You steady yourself on the flat ground, the silence pressing in around you—heavy, but no longer suffocating.</span><br>
            <span>Your legs shake beneath you, but you're standing.</span><br>
            <span>The sky above is muted, washed in dull grey, the clouds low and unmoving.</span><br>
            <span>Ahead, something breaks the horizon—a small shape, dark against the pale landscape.</span><br>
            <span>It's a cabin. Wooden. Still. Almost out of place.</span><br>
            <span>But it's there. And it's the only thing in sight.</span><br><br>
            <span onclick="approachCabin()">Walk closer...</span>
        </div>
        <div id="open" onclick="openDoor()">Open</div>
        <div id="infosG">
            <span>You step inside the cabin, the wooden door creaking shut behind you.</span><br>
            <span>The air inside is heavy, thick with an odd, cloying scent you can't quite place.</span><br>
            <span>Your head spins lightly, a dizziness creeping in—long hours of strain catching up.</span><br>
            <span>The walls seem to breathe, shadows twisting just beyond your vision.</span><br>
            <span>Shapes flicker at the edge of your sight, whispering voices echoing in the silence.</span><br>
            <span>You remind yourself: not everything here is what it seems.</span><br>
            <span>Trust your senses carefully. Distinguish the real from the illusions—</span><br>
            <span>Because some dangers wear a mask you can't see. Kick the hallucinations - you're safe. Kick the danger - you'll die.</span><br><br>
            <span style="color: rgb(83, 20, 255);">Don't trust the small, the sun, and the dust.</span><br><br>
            <span onclick="exploreCabin()" >Continue...</span>
        </div>
        <div id="hallucinations"></div>
    </div>

    <!--------------------------------------
    ---------------Died Screen--------------
    ---------------------------------------->
    <div id="diedScreen">
        <div id="diedText">
            <p id="diedHeader">Unfortunately you died</p>
            <p id="diedText1">Do you want to save your score to the leaderboard or play again?</p>
        </div>
        <div id="buttons">
            <div id="saveLeaderboard">Leaderboard</div>
            <div id="tryAgain" onclick="tryAgain()">Try Again</div>
        </div>
    </div>

    <!--------------------------------------
    ---------------Leaderboard--------------
    ---------------------------------------->
    <div id="leaderboardScreen">
        <div id="drainColor"></div>
        <p id="leaderboardHeader">Leaderboard</p>
        <div id="leaderBoardList">
            <ol id="scoreList"></ol>
        </div>
        <div id="backToStart" onclick="tryAgain()">Back to Start</div>
    </div>
</body>
</html>